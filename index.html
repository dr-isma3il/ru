<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –°–ì–ú–£ v32 PWA | –≠–ª—Å–∞–≥–∏—Ä –ò—Å–º–∞–∏–ª</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéì</text></svg>">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e3c72">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="–°–ì–ú–£ 2026">
    <link rel="apple-touch-icon" href="icon-192.svg">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--primary:#1e3c72;--secondary:#2a5298;--glass:rgba(255,255,255,0.95);--shadow:0 10px 30px rgba(0,0,0,0.3)}
        body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 50%,#1e3c72 100%);min-height:100vh;padding:20px;color:#333}
        .container{max-width:1400px;margin:0 auto;width:100%}
        header{text-align:center;color:white;margin-bottom:30px;animation:fadeIn 1s;width:100%}
        h1{font-size:2.5em;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,0.3)}
        .version-badge{display:inline-block;background:#ffd700;color:#000;padding:5px 15px;border-radius:20px;font-weight:bold;font-size:0.9em;margin-top:10px}
        .author-info{margin-top:15px;padding:10px 20px;background:rgba(255,255,255,0.15);border-radius:25px;display:inline-block;backdrop-filter:blur(5px)}
        .author-info a{color:#ffd700;text-decoration:none;font-weight:bold}
        .quick-actions{display:flex;gap:15px;justify-content:center;flex-wrap:wrap;margin-bottom:20px;width:100%}
        .action-btn{padding:15px 25px;border:none;border-radius:15px;cursor:pointer;font-weight:bold;font-size:1em;transition:all 0.3s;display:flex;align-items:center;gap:8px;box-shadow:0 4px 15px rgba(0,0,0,0.2)}
        .btn-today{background:linear-gradient(135deg,#48bb78,#38a169);color:white}
        .btn-tomorrow{background:linear-gradient(135deg,#ed8936,#dd6b20);color:white}
        .btn-export{background:linear-gradient(135deg,#4299e1,#3182ce);color:white}
        .btn-install{background:linear-gradient(135deg,#9f7aea,#805ad5);color:white}
        .action-btn:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 8px 25px rgba(0,0,0,0.3)}
        .favorites-btn{position:fixed;top:20px;right:20px;background:#f56565;color:white;padding:15px;border-radius:50%;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.3);z-index:100;font-size:1.5em;transition:all 0.3s}
        .favorites-btn:hover{transform:scale(1.1) rotate(10deg)}
        .favorites-count{position:absolute;top:-5px;right:-5px;background:#2d3748;color:white;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-size:0.7em;font-weight:bold}
        .stats-bar{background:var(--glass);padding:20px;border-radius:15px;margin-bottom:20px;box-shadow:var(--shadow);display:none;width:100%}
        .stats-bar.active{display:block;animation:slideUp 0.4s}
        .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px}
        .stat-card{background:linear-gradient(135deg,#f7fafc,#edf2f7);padding:15px;border-radius:12px;text-align:center;border-left:4px solid var(--primary)}
        .stat-number{font-size:2em;font-weight:bold;color:var(--primary)}
        .stat-label{color:#666;font-size:0.9em;margin-top:5px}
        .controls{background:var(--glass);padding:25px;border-radius:20px;margin-bottom:30px;box-shadow:var(--shadow);backdrop-filter:blur(10px);display:flex;flex-wrap:wrap;gap:20px;align-items:center;justify-content:center;width:100%}
        .search-box{display:flex;flex-direction:column;gap:8px}
        .search-box label{font-weight:bold;color:var(--primary);font-size:0.9em}
        input[type="date"]{padding:12px 16px;border:2px solid #e2e8f0;border-radius:12px;font-size:1em;min-width:200px;transition:all 0.3s}
        input[type="date"]:focus{outline:none;border-color:var(--secondary);box-shadow:0 0 0 3px rgba(42,82,152,0.1)}
        .btn{padding:12px 24px;border:none;border-radius:12px;cursor:pointer;font-weight:bold;transition:all 0.3s;font-size:1em}
        .btn-primary{background:var(--primary);color:white}
        .btn-primary:hover{background:var(--secondary);transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,0.2)}
        .btn-secondary{background:#e2e8f0;color:var(--primary)}
        .btn-secondary:hover{background:#cbd5e0}
        .schedule-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(380px,1fr));gap:25px;width:100%}
        .day-card{background:var(--glass);border-radius:20px;padding:25px;box-shadow:var(--shadow);backdrop-filter:blur(10px);animation:slideUp 0.6s;display:none;width:100%}
        .day-card.active{display:block}
        @keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        @keyframes fadeIn{from{opacity:0}to{opacity:1}}
        .day-header{font-size:1.6em;font-weight:bold;color:var(--primary);margin-bottom:20px;padding-bottom:10px;border-bottom:3px solid #64b5f6;display:flex;align-items:center;justify-content:space-between}
        .lesson{margin:20px 0;border-radius:12px;overflow:hidden;transition:all 0.3s;cursor:pointer;position:relative}
        .lesson:hover{transform:translateX(5px) scale(1.02);box-shadow:0 5px 20px rgba(0,0,0,0.2);z-index:10}
        .lesson-progress{padding:10px 15px;background:rgba(255,255,255,0.9);border-top:1px dashed #cbd5e0;font-size:0.85em}
        .progress-bar{width:100%;height:8px;background:#e2e8f0;border-radius:4px;overflow:hidden;margin:8px 0}
        .progress-fill{height:100%;background:linear-gradient(90deg,#48bb78,#38a169);border-radius:4px;transition:width 0.5s}
        .progress-text{display:flex;justify-content:space-between;color:#4a5568;font-size:0.9em}
        .next-lesson{color:#2b6cb0;font-weight:600;margin-top:5px}
        .lesson-header{padding:15px;display:flex;justify-content:space-between;align-items:flex-start;gap:10px}
        .lesson-time{font-weight:bold;font-size:0.95em;opacity:0.9;min-width:100px}
        .lesson-title{font-weight:600;font-size:1.1em;flex:1;line-height:1.3}
        .lesson-badge{background:rgba(255,255,255,0.3);padding:4px 10px;border-radius:20px;font-size:0.75em;font-weight:bold;white-space:nowrap}
        .favorite-star{position:absolute;top:10px;right:10px;cursor:pointer;font-size:1.3em;opacity:0;transition:all 0.3s;text-shadow:0 2px 4px rgba(0,0,0,0.2)}
        .lesson:hover .favorite-star{opacity:1}
        .favorite-star.active{opacity:1;color:#ffd700}
        .pharma{background:linear-gradient(135deg,#c6f6d5,#9ae6b4);border-left:5px solid #48bb78}
        .anatomy{background:linear-gradient(135deg,#fed7d7,#feb2b2);border-left:5px solid #f56565}
        .pathophys{background:linear-gradient(135deg,#e9d8fd,#d6bcfa);border-left:5px solid #9f7aea}
        .surgery{background:linear-gradient(135deg,#feebc8,#fbd38d);border-left:5px solid #ed8936}
        .propedeutics{background:linear-gradient(135deg,#b2f5ea,#81e6d9);border-left:5px solid #38b2ac}
        .immunology{background:linear-gradient(135deg,#fefcbf,#faf089);border-left:5px solid #d69e2e}
        .rki{background:linear-gradient(135deg,#bee3f8,#90cdf4);border-left:5px solid #4299e1}
        .cycle{background:linear-gradient(135deg,#e2e8f0,#cbd5e0);border-left:5px solid #718096}
        .emergency{background:linear-gradient(135deg,#feb2b2,#fc8181);border-left:5px solid #c53030}
        .health{background:linear-gradient(135deg,#fed7e2,#fbb6ce);border-left:5px solid #d53f8c}
        .topographic{background:linear-gradient(135deg,#feebc8,#f6ad55);border-left:5px solid #dd6b20}
        .biochem{background:linear-gradient(135deg,#d6f5d6,#9ae6b4);border-left:5px solid #38a169}
        .pe{background:linear-gradient(135deg,#c6f6d5,#9ae6b4);border-left:5px solid #2f855a}
        .cycle-details{background:rgba(255,255,255,0.7);padding:10px 15px;border-top:1px dashed #cbd5e0;font-size:0.9em}
        .cycle-item{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid #e2e8f0}
        .cycle-item:last-child{border-bottom:none}
        .cycle-period{font-size:0.85em;color:#718096;background:#edf2f7;padding:2px 8px;border-radius:10px}
        .modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);backdrop-filter:blur(5px);z-index:1000;justify-content:center;align-items:center;padding:20px}
        .modal-overlay.active{display:flex;animation:fadeIn 0.3s}
        .modal{background:white;border-radius:24px;max-width:600px;width:100%;max-height:90vh;overflow-y:auto;box-shadow:0 25px 50px -12px rgba(0,0,0,0.5);animation:slideUp 0.4s}
        .modal-header{padding:25px;background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;border-radius:24px 24px 0 0;position:relative}
        .modal-title{font-size:1.5em;font-weight:bold;margin-bottom:5px}
        .modal-time{opacity:0.9;font-size:1.1em}
        .close-btn{position:absolute;top:20px;right:20px;background:rgba(255,255,255,0.2);border:none;color:white;width:36px;height:36px;border-radius:50%;cursor:pointer;font-size:1.2em;transition:all 0.3s}
        .close-btn:hover{background:rgba(255,255,255,0.3);transform:rotate(90deg)}
        .modal-body{padding:25px}
        .info-section{margin-bottom:20px;padding:15px;background:#f7fafc;border-radius:12px;border-left:4px solid var(--primary)}
        .info-section h3{color:var(--primary);margin-bottom:8px;font-size:1em;text-transform:uppercase;letter-spacing:1px}
        .info-section p{color:#4a5568;line-height:1.6;font-size:1.05em}
        .map-link{display:inline-flex;align-items:center;gap:8px;color:var(--primary);text-decoration:none;font-weight:bold;margin-top:10px;padding:8px 16px;background:#ebf8ff;border-radius:8px;transition:all 0.3s}
        .map-link:hover{background:var(--primary);color:white;transform:translateY(-2px)}
        .dates-list{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
        .date-tag{background:var(--primary);color:white;padding:4px 12px;border-radius:20px;font-size:0.85em;font-weight:500}
        .conflict-notice{background:#fed7d7;color:#742a2a;padding:12px;border-radius:8px;margin-bottom:15px;font-weight:bold;text-align:center;border:2px dashed #fc8181}
        .results-info{background:#c6f6d5;color:#22543d;padding:15px;border-radius:12px;margin-bottom:20px;text-align:center;font-weight:bold;display:none;width:100%}
        .results-info.active{display:block;animation:slideUp 0.4s}
        .no-results{text-align:center;color:white;font-size:1.3em;padding:40px;display:none;width:100%}
        .no-results.active{display:block}
        .current-day{background:#ffd700!important;color:#000!important;animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .install-banner{display:none;position:fixed;bottom:0;left:0;right:0;background:linear-gradient(135deg,#1e3c72,#2a5298);color:white;padding:16px 20px;z-index:999;box-shadow:0 -4px 20px rgba(0,0,0,0.3);animation:slideUp 0.5s}
        .install-banner.active{display:flex;align-items:center;justify-content:space-between;gap:12px}
        .install-banner-text{flex:1}
        .install-banner-text strong{display:block;font-size:1.1em}
        .install-banner-text span{font-size:0.85em;opacity:0.85}
        .install-banner-btn{background:#ffd700;color:#000;border:none;padding:10px 24px;border-radius:25px;font-weight:bold;cursor:pointer;white-space:nowrap}
        .install-banner-close{background:none;border:none;color:white;font-size:1.5em;cursor:pointer;opacity:0.7;padding:5px}
        .offline-badge{display:none;position:fixed;top:60px;right:20px;background:#e53e3e;color:white;padding:8px 16px;border-radius:20px;font-size:0.85em;font-weight:bold;z-index:101}
        .offline-badge.active{display:block}
        footer{text-align:center;color:white;margin-top:50px;padding:30px;background:rgba(0,0,0,0.2);border-radius:20px;backdrop-filter:blur(10px);width:100%}
        .footer-content{display:flex;flex-direction:column;gap:10px}
        .footer-name{font-size:1.3em;font-weight:bold;color:#ffd700}
        .footer-links{display:flex;justify-content:center;gap:20px;flex-wrap:wrap;margin-top:10px}
        .footer-links a{color:white;text-decoration:none;padding:8px 16px;background:rgba(255,255,255,0.1);border-radius:20px;transition:all 0.3s}
        .footer-links a:hover{background:rgba(255,255,255,0.2);transform:translateY(-2px)}
        .legend{background:var(--glass);padding:20px;border-radius:15px;margin-bottom:20px;box-shadow:var(--shadow);width:100%}
        .legend h3{color:var(--primary);margin-bottom:15px;text-align:center}
        .legend-items{display:flex;flex-wrap:wrap;gap:12px;justify-content:center}
        .legend-item{display:flex;align-items:center;gap:6px;font-size:0.85em;cursor:pointer;padding:6px 12px;border-radius:20px;transition:all 0.3s}
        .legend-item:hover{background:rgba(0,0,0,0.05);transform:translateY(-2px)}
        .legend-item.hidden{opacity:0.5;text-decoration:line-through}
        .color-box{width:16px;height:16px;border-radius:4px}
        @media(max-width:768px){
            body{padding:10px;width:100vw;max-width:100vw;overflow-x:hidden}
            .container{width:100%;padding:0 5px}
            h1{font-size:1.8em}
            .author-info{width:95%;padding:10px;margin:10px auto}
            .quick-actions{flex-direction:column;gap:10px;padding:0}
            .action-btn{width:100%;padding:16px 20px;justify-content:center}
            .controls{flex-direction:column;padding:15px;gap:12px}
            .search-box{width:100%}
            input[type="date"]{width:100%;min-width:auto;padding:14px;font-size:1.1em}
            .btn{width:100%;padding:14px;font-size:1.1em}
            .legend{padding:15px}
            .legend-items{gap:8px}
            .legend-item{font-size:0.8em;padding:4px 8px}
            .stats-grid{grid-template-columns:1fr;gap:10px}
            .schedule-grid{grid-template-columns:1fr;gap:15px}
            .day-card{padding:20px 15px;border-radius:15px}
            .day-header{font-size:1.3em}
            .lesson{margin:15px 5px;border-radius:10px}
            .lesson-header{padding:12px}
            .lesson-title{font-size:1em}
            .favorites-btn{top:10px;right:10px;padding:12px;font-size:1.2em}
            .modal{margin:10px;width:calc(100% - 20px);max-height:95vh}
            footer{margin-top:20px;padding:20px 10px}
            .footer-links{flex-direction:column;align-items:center;gap:8px}
            .install-banner{flex-direction:column;text-align:center;padding:20px}
        }
    </style>
</head>
<body>
    <div class="favorites-btn" onclick="showFavorites()">‚≠ê<span class="favorites-count" id="favCount">0</span></div>
    <div class="offline-badge" id="offlineBadge">üìµ –û—Ñ–ª–∞–π–Ω</div>
    <div class="container">
        <header>
            <h1>üìö –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –°–ì–ú–£</h1>
            <p style="opacity:0.9;">–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∏–π –ì–ú–£ | –í–µ—Å–Ω–∞ 2026</p>
            <div class="version-badge">v32 PWA ‚ö°</div>
            <div class="author-info">–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ: <strong>–≠–ª—Å–∞–≥–∏—Ä –ò—Å–º–∞–∏–ª</strong> | <a href="https://t.me/dr.elsaghir" target="_blank">üì± @dr.elsaghir</a></div>
        </header>
        <div class="quick-actions">
            <button class="action-btn btn-today" onclick="showToday()">üåÖ –°–ï–ì–û–î–ù–Ø <span id="todayDate" style="font-size:0.8em;opacity:0.9;"></span></button>
            <button class="action-btn btn-tomorrow" onclick="showTomorrow()">üåÑ –ó–ê–í–¢–†–ê <span id="tomorrowDate" style="font-size:0.8em;opacity:0.9;"></span></button>
            <button class="action-btn btn-export" onclick="exportICS()">üì§ –≠–ö–°–ü–û–†–¢</button>
            <button class="action-btn btn-install" id="installBtn" style="display:none;" onclick="installPWA()">üì≤ –£–°–¢–ê–ù–û–í–ò–¢–¨</button>
        </div>
        <div class="stats-bar" id="statsBar"><div class="stats-grid" id="statsGrid"></div></div>
        <div class="controls">
            <div class="search-box"><label>üîç –ü–æ–∏—Å–∫ –ø–æ –¥–∞—Ç–µ</label><input type="date" id="dateSearch"></div>
            <button class="btn btn-primary" onclick="searchByDate()">–ù–∞–π—Ç–∏</button>
            <button class="btn btn-secondary" onclick="showAll()">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å—ë</button>
            <button class="btn btn-secondary" onclick="clearSearch()">–°–±—Ä–æ—Å–∏—Ç—å</button>
        </div>
        <div class="results-info" id="resultsInfo"></div>
        <div class="no-results" id="noResults">üì≠ –ù–∞ —ç—Ç—É –¥–∞—Ç—É –∑–∞–Ω—è—Ç–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>
        <div class="legend"><div class="legend-items" id="legend"></div></div>
        <div class="schedule-grid" id="scheduleGrid"></div>
    </div>
    <footer><div class="footer-content"><div class="footer-name">¬© 2026 –≠–ª—Å–∞–≥–∏—Ä –ò—Å–º–∞–∏–ª</div><div>–°–ì–ú–£ | PWA v32</div><div class="footer-links"><a href="https://t.me/dr.elsaghir" target="_blank">üì± Telegram</a><a href="#" onclick="alert('v32 PWA\n–≠–ª—Å–∞–≥–∏—Ä –ò—Å–º–∞–∏–ª\n¬© 2026')">‚ÑπÔ∏è –û –ø—Ä–æ–µ–∫—Ç–µ</a></div></div></footer>
    <div class="install-banner" id="installBanner"><div class="install-banner-text"><strong>üì≤ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</strong><span>–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –±–µ–∑ –±—Ä–∞—É–∑–µ—Ä–∞</span></div><button class="install-banner-btn" onclick="installPWA()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button><button class="install-banner-close" onclick="dismissInstall()">√ó</button></div>
    <div class="modal-overlay" id="modal" onclick="closeModal(event)"><div class="modal" onclick="event.stopPropagation()"><div class="modal-header"><div class="modal-title" id="modalTitle"></div><div class="modal-time" id="modalTime"></div><button class="close-btn" onclick="closeModal()">√ó</button></div><div class="modal-body" id="modalBody"></div></div></div>
    <script>
        const CURRENT_DATE = new Date();
        const cycleData = {
            tuesday: [
                {name:"–û–±—â–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è",period:"16/04‚Äì30/04, 05/05‚Äì07/05",location:"–°–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141"},
                {name:"–ù–µ–æ—Ç–ª–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è",period:"15/05‚Äì20/05",location:"–∫–æ—Ä–ø—É—Å ‚Ññ7",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137"},
                {name:"–ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∞",period:"21/05‚Äì11/06",location:"–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141"}
            ],
            wednesday: [
                {name:"–¢–æ–ø–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞–Ω–∞—Ç–æ–º–∏—è",period:"11/02‚Äì06/03",location:"–∫–æ—Ä–ø—É—Å ‚Ññ2",address:"—É–ª.–ú–æ—Å–∫–æ–≤—Å–∫–∞—è,155–ï",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ú–æ—Å–∫–æ–≤—Å–∫–∞—è+155–ï"},
                {name:"–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",period:"11/03‚Äì27/03",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137"},
                {name:"–ò–º–º—É–Ω–æ–ª–æ–≥–∏—è –∏ –∞–ª–ª–µ—Ä–≥–æ–ª–æ–≥–∏—è",period:"01/04‚Äì15/04",location:"–£–ö–ë ‚Ññ2",address:"—É–ª.–ü—Ä–æ–≤–∏–∞–Ω—Ç—Å–∫–∞—è,22",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ü—Ä–æ–≤–∏–∞–Ω—Ç—Å–∫–∞—è+22"},
                {name:"–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –±–∏–æ—Ö–∏–º–∏—è",period:"01/04‚Äì15/04",location:"–∫–æ—Ä–ø—É—Å ‚Ññ2",address:"—É–ª.–ú–æ—Å–∫–æ–≤—Å–∫–∞—è,155–ï",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ú–æ—Å–∫–æ–≤—Å–∫–∞—è+155–ï"},
                {name:"–û–±—â–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è",period:"16/04‚Äì30/04, 05/05‚Äì07/05",location:"–°–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141"},
                {name:"–ù–µ–æ—Ç–ª–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è",period:"15/05‚Äì20/05",location:"–∫–æ—Ä–ø—É—Å ‚Ññ7",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137"},
                {name:"–ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∞",period:"21/05‚Äì11/06",location:"–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141"}
            ],
            thursday: [
                {name:"–¢–æ–ø–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞–Ω–∞—Ç–æ–º–∏—è",period:"11/02‚Äì06/03",location:"–∫–æ—Ä–ø—É—Å ‚Ññ2",address:"—É–ª.–ú–æ—Å–∫–æ–≤—Å–∫–∞—è,155–ï",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ú–æ—Å–∫–æ–≤—Å–∫–∞—è+155–ï"},
                {name:"–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",period:"11/03‚Äì27/03",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137"},
                {name:"–ò–º–º—É–Ω–æ–ª–æ–≥–∏—è –∏ –∞–ª–ª–µ—Ä–≥–æ–ª–æ–≥–∏—è",period:"01/04‚Äì15/04",location:"–£–ö–ë ‚Ññ2",address:"—É–ª.–ü—Ä–æ–≤–∏–∞–Ω—Ç—Å–∫–∞—è,22",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ü—Ä–æ–≤–∏–∞–Ω—Ç—Å–∫–∞—è+22"},
                {name:"–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –±–∏–æ—Ö–∏–º–∏—è",period:"01/04‚Äì15/04",location:"–∫–æ—Ä–ø—É—Å ‚Ññ2",address:"—É–ª.–ú–æ—Å–∫–æ–≤—Å–∫–∞—è,155–ï",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ú–æ—Å–∫–æ–≤—Å–∫–∞—è+155–ï"},
                {name:"–û–±—â–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è",period:"16/04‚Äì30/04, 05/05‚Äì07/05",location:"–°–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141"},
                {name:"–ù–µ–æ—Ç–ª–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è",period:"15/05‚Äì20/05",location:"–∫–æ—Ä–ø—É—Å ‚Ññ7",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137"},
                {name:"–ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∞",period:"21/05‚Äì11/06",location:"–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141"}
            ],
            friday: [
                {name:"–¢–æ–ø–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞–Ω–∞—Ç–æ–º–∏—è",period:"11/02‚Äì06/03",location:"–∫–æ—Ä–ø—É—Å ‚Ññ2",address:"—É–ª.–ú–æ—Å–∫–æ–≤—Å–∫–∞—è,155–ï",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ú–æ—Å–∫–æ–≤—Å–∫–∞—è+155–ï"},
                {name:"–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",period:"11/03‚Äì27/03",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137"},
                {name:"–ò–º–º—É–Ω–æ–ª–æ–≥–∏—è –∏ –∞–ª–ª–µ—Ä–≥–æ–ª–æ–≥–∏—è",period:"01/04‚Äì15/04",location:"–£–ö–ë ‚Ññ2",address:"—É–ª.–ü—Ä–æ–≤–∏–∞–Ω—Ç—Å–∫–∞—è,22",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ü—Ä–æ–≤–∏–∞–Ω—Ç—Å–∫–∞—è+22"},
                {name:"–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –±–∏–æ—Ö–∏–º–∏—è",period:"01/04‚Äì15/04",location:"–∫–æ—Ä–ø—É—Å ‚Ññ2",address:"—É–ª.–ú–æ—Å–∫–æ–≤—Å–∫–∞—è,155–ï",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ú–æ—Å–∫–æ–≤—Å–∫–∞—è+155–ï"},
                {name:"–û–±—â–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è",period:"16/04‚Äì30/04, 05/05‚Äì07/05",location:"–°–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141"},
                {name:"–ù–µ–æ—Ç–ª–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è",period:"15/05‚Äì20/05",location:"–∫–æ—Ä–ø—É—Å ‚Ññ7",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137"},
                {name:"–ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∞",period:"21/05‚Äì11/06",location:"–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141"}
            ]
        };
        function getFormattedDate(d){return String(d.getDate()).padStart(2,'0')+'/'+String(d.getMonth()+1).padStart(2,'0');}
        function getRussianDate(d){const m=['—è–Ω–≤–∞—Ä—è','—Ñ–µ–≤—Ä–∞–ª—è','–º–∞—Ä—Ç–∞','–∞–ø—Ä–µ–ª—è','–º–∞—è','–∏—é–Ω—è','–∏—é–ª—è','–∞–≤–≥—É—Å—Ç–∞','—Å–µ–Ω—Ç—è–±—Ä—è','–æ–∫—Ç—è–±—Ä—è','–Ω–æ—è–±—Ä—è','–¥–µ–∫–∞–±—Ä—è'];return d.getDate()+' '+m[d.getMonth()];}
        document.getElementById('todayDate').textContent=getRussianDate(CURRENT_DATE);
        const tomorrow=new Date(CURRENT_DATE);tomorrow.setDate(tomorrow.getDate()+1);
        document.getElementById('tomorrowDate').textContent=getRussianDate(tomorrow);
        function getDatesForDay(s,e,dn){const r=[];const[sd,sm]=s.split('/').map(Number);const[ed,em]=e.split('/').map(Number);let c=new Date(2026,sm-1,sd);const en=new Date(2026,em-1,ed);while(c<=en){if(c.getDay()===dn)r.push(getFormattedDate(c));c.setDate(c.getDate()+1);}return r;}
        function getMondays(s,e){return getDatesForDay(s,e,1);}function getTuesdays(s,e){return getDatesForDay(s,e,2);}function getWednesdays(s,e){return getDatesForDay(s,e,3);}function getThursdays(s,e){return getDatesForDay(s,e,4);}function getFridays(s,e){return getDatesForDay(s,e,5);}
        function parseDateRange(ds,dw=null){if(!ds||ds==='‚Äî')return[];const parts=ds.split(', ');const all=[];parts.forEach(p=>{if(p.includes('‚Äì')){const[st,en]=p.split('‚Äì');const s=st.trim(),e=en.trim();if(s==='09/02'&&e==='16/02')all.push('09/02','16/02');else if(s==='18/05'&&e==='08/06')all.push(...getMondays(s,e));else if(s==='16/03'&&e==='04/05')all.push(...getMondays(s,e));else if(s==='28/04'&&e==='09/06')all.push(...getTuesdays(s,e));else if(s==='09/02'&&e==='11/06'){if(dw===3)all.push(...getWednesdays(s,e));else if(dw===4)all.push(...getThursdays(s,e));else if(dw===5)all.push(...getFridays(s,e));}else if(s==='11/02'&&e==='13/05')all.push(...getWednesdays(s,e));else if(s==='11/02'&&e==='06/05')all.push(...getWednesdays(s,e));else if(s==='19/03'&&e==='16/04')all.push(...getThursdays(s,e));else if(s==='07/05'&&e==='04/06')all.push(...getThursdays(s,e));else if(s==='15/05'&&e==='05/06')all.push(...getFridays(s,e));else if(s==='20/05'&&e==='10/06')all.push(...getWednesdays(s,e));else if(s==='13/02'&&e==='24/04')all.push(...getFridays(s,e));else if(s==='15/05'&&e==='22/05')all.push(...getFridays(s,e));else if(s==='25/05'&&e==='01/06')all.push(...getMondays(s,e));else all.push(s,e);}else all.push(p.trim());});return[...new Set(all)].sort((a,b)=>{const[da,ma]=a.split('/').map(Number);const[db,mb]=b.split('/').map(Number);return(ma*100+da)-(mb*100+db);});}
        const lessonsData=[
            {day:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",time:"08:30‚Äì10:00",subject:"–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ (–†–ö–ò)",type:"15 –¥–Ω–µ–π",dateRanges:"09/02‚Äì16/02, 02/03, 16/03‚Äì04/05, 18/05‚Äì08/06",dayOfWeek:1,category:"rki",professor:"–ö–∞—Ñ. –†—É—Å—Å–∫–æ–≥–æ –∏ –ª–∞—Ç–∏–Ω—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",dates:[]},
            {day:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",time:"10:10‚Äì11:40",subject:"–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ (–†–ö–ò)",type:"15 –¥–Ω–µ–π",dateRanges:"09/02‚Äì16/02, 02/03, 16/03‚Äì04/05, 18/05‚Äì08/06",dayOfWeek:1,category:"rki",professor:"–ö–∞—Ñ. –†—É—Å—Å–∫–æ–≥–æ –∏ –ª–∞—Ç–∏–Ω—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",dates:[]},
            {day:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",time:"12:10‚Äì13:40",subject:"–ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∞–Ω–∞—Ç–æ–º–∏—è",type:"12 –¥–Ω–µ–π",dateRanges:"09/02‚Äì16/02, 02/03, 16/03‚Äì04/05, 18/05",dayOfWeek:1,category:"anatomy",professor:"–ö–∞—Ñ. –ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –∞–Ω–∞—Ç–æ–º–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ4 –°–ì–ú–£",address:"—É–ª.–ë.–ö–∞–∑–∞—á—å—è,112",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–ö–∞–∑–∞—á—å—è+112",dates:[]},
            {day:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",time:"12:20‚Äì13:50",subject:"–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è",type:"2 –¥–Ω—è",dateRanges:"25/05‚Äì01/06",dayOfWeek:1,category:"pharma",professor:"–ö–∞—Ñ. –§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ö—É—Ç—è–∫–æ–≤–∞,109",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ö—É—Ç—è–∫–æ–≤–∞+109",dates:[]},
            {day:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",time:"13:50‚Äì15:20",subject:"–ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∞–Ω–∞—Ç–æ–º–∏—è",type:"12 –¥–Ω–µ–π",dateRanges:"09/02‚Äì16/02, 02/03, 16/03‚Äì04/05, 18/05",dayOfWeek:1,category:"anatomy",professor:"–ö–∞—Ñ. –ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –∞–Ω–∞—Ç–æ–º–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ4 –°–ì–ú–£",address:"—É–ª.–ë.–ö–∞–∑–∞—á—å—è,112",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–ö–∞–∑–∞—á—å—è+112",dates:[]},
            {day:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",time:"14:00‚Äì15:30",subject:"–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è",type:"2 –¥–Ω—è",dateRanges:"25/05‚Äì01/06",dayOfWeek:1,category:"pharma",professor:"–ö–∞—Ñ. –§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ö—É—Ç—è–∫–æ–≤–∞,109",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ö—É—Ç—è–∫–æ–≤–∞+109",dates:[]},
            {day:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",time:"16:10‚Äì17:40",subject:"–ü–∞—Ç–æ—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—è (–ª–µ–∫—Ü–∏—è)",type:"9 –¥–Ω–µ–π",dateRanges:"09/02, 16/02, 02/03, 16/03, 23/03, 30/03, 06/04, 13/04, 20/04",dayOfWeek:1,category:"pathophys",professor:"–ö–∞—Ñ. –ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ñ–∏–∑–∏–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ4 –°–ì–ú–£",address:"—É–ª.–ë.–ö–∞–∑–∞—á—å—è,112",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–ö–∞–∑–∞—á—å—è+112",dates:[]},
            {day:"–í—Ç–æ—Ä–Ω–∏–∫",time:"08:30‚Äì10:00",subject:"–¶–ò–ö–õ",type:"28/04‚Äì09/06",dateRanges:"28/04‚Äì09/06",dayOfWeek:2,category:"cycle",isCycle:true,cycleDay:"tuesday",dates:[]},
            {day:"–í—Ç–æ—Ä–Ω–∏–∫",time:"09:00‚Äì10:30",subject:"–û–±—â–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è (–ª–µ–∫—Ü–∏—è)",type:"6 –¥–Ω–µ–π",dateRanges:"10/02, 24/02, 10/03, 24/03, 07/04, 21/04",dayOfWeek:2,category:"surgery",professor:"–ö–∞—Ñ. –û–±—â–µ–π —Ö–∏—Ä—É—Ä–≥–∏–∏",location:"–°–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141",dates:[]},
            {day:"–í—Ç–æ—Ä–Ω–∏–∫",time:"09:00‚Äì10:30",subject:"–ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∞ (–ª–µ–∫—Ü–∏—è)",type:"5 –¥–Ω–µ–π",dateRanges:"17/02, 03/03, 17/03, 31/03, 14/04",dayOfWeek:2,category:"propedeutics",professor:"–ö–∞—Ñ. –ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –±–æ–ª–µ–∑–Ω–µ–π",location:"–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141",dates:[]},
            {day:"–í—Ç–æ—Ä–Ω–∏–∫",time:"10:10‚Äì11:40",subject:"–¶–ò–ö–õ",type:"28/04‚Äì09/06",dateRanges:"28/04‚Äì09/06",dayOfWeek:2,category:"cycle",isCycle:true,cycleDay:"tuesday",dates:[]},
            {day:"–í—Ç–æ—Ä–Ω–∏–∫",time:"11:00‚Äì12:30",subject:"–ò–º–º—É–Ω–æ–ª–æ–≥–∏—è –∏ –∞–ª–ª–µ—Ä–≥–æ–ª–æ–≥–∏—è",type:"8 –¥–Ω–µ–π",dateRanges:"10/02, 17/02, 24/02, 03/03, 10/03, 17/03, 24/03, 31/03",dayOfWeek:2,category:"immunology",professor:"–ö–∞—Ñ. –ö–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –∏–º–º—É–Ω–æ–ª–æ–≥–∏–∏",location:"–£–ö–ë ‚Ññ2",address:"—É–ª.–ü—Ä–æ–≤–∏–∞–Ω—Ç—Å–∫–∞—è,22",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ü—Ä–æ–≤–∏–∞–Ω—Ç—Å–∫–∞—è+22",dates:[]},
            {day:"–í—Ç–æ—Ä–Ω–∏–∫",time:"11:10‚Äì12:40",subject:"–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",type:"3 –¥–Ω—è",dateRanges:"07/04, 14/04, 21/04",dayOfWeek:2,category:"health",professor:"–ö–∞—Ñ. –û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"08:30‚Äì10:00",subject:"–¶–ò–ö–õ",type:"09/02‚Äì11/06",dateRanges:"09/02‚Äì11/06",dayOfWeek:3,category:"cycle",isCycle:true,cycleDay:"wednesday",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"10:10‚Äì11:40",subject:"–¶–ò–ö–õ",type:"09/02‚Äì11/06",dateRanges:"09/02‚Äì11/06",dayOfWeek:3,category:"cycle",isCycle:true,cycleDay:"wednesday",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"12:20‚Äì13:50",subject:"–ü–∞—Ç–æ—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—è",type:"14 –¥–Ω–µ–π",dateRanges:"11/02‚Äì13/05",dayOfWeek:3,category:"pathophys",professor:"–ö–∞—Ñ. –ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ñ–∏–∑–∏–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ4 –°–ì–ú–£",address:"—É–ª.–ë.–ö–∞–∑–∞—á—å—è,112",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–ö–∞–∑–∞—á—å—è+112",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"14:00‚Äì15:30",subject:"–ü–∞—Ç–æ—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—è",type:"13 –¥–Ω–µ–π",dateRanges:"11/02‚Äì06/05",dayOfWeek:3,category:"pathophys",professor:"–ö–∞—Ñ. –ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ñ–∏–∑–∏–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ4 –°–ì–ú–£",address:"—É–ª.–ë.–ö–∞–∑–∞—á—å—è,112",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–ö–∞–∑–∞—á—å—è+112",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"15:40‚Äì17:10",subject:"–ö–ª–∏–Ω. –±–∏–æ—Ö–∏–º–∏—è (–ª–µ–∫—Ü–∏—è)",type:"3 –¥–Ω—è",dateRanges:"11/02, 11/03, 08/04",dayOfWeek:3,category:"biochem",professor:"–ö–∞—Ñ. –ë–∏–æ—Ö–∏–º–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ2 –°–ì–ú–£",address:"—É–ª.–ú–æ—Å–∫–æ–≤—Å–∫–∞—è,155–ï",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ú–æ—Å–∫–æ–≤—Å–∫–∞—è+155–ï",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"15:40‚Äì17:10",subject:"–¢–æ–ø–æ–≥—Ä–∞—Ñ. –∞–Ω–∞—Ç–æ–º–∏—è (–ª–µ–∫—Ü–∏—è)",type:"6 –¥–Ω–µ–π",dateRanges:"25/02, 25/03, 22/04, 06/05, 20/05, 03/06",dayOfWeek:3,category:"topographic",professor:"–ö–∞—Ñ. –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ö–∏—Ä—É—Ä–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ2 –°–ì–ú–£",address:"—É–ª.–ú–æ—Å–∫–æ–≤—Å–∫–∞—è,155–ï",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ú–æ—Å–∫–æ–≤—Å–∫–∞—è+155–ï",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"15:50‚Äì17:20",subject:"–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è (–ª–µ–∫—Ü–∏—è)",type:"7 –¥–Ω–µ–π",dateRanges:"18/02, 04/03, 18/03, 01/04, 15/04, 29/04, 13/05",dayOfWeek:3,category:"pharma",professor:"–ö–∞—Ñ. –§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ö—É—Ç—è–∫–æ–≤–∞,109",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ö—É—Ç—è–∫–æ–≤–∞+109",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"17:50‚Äì19:20",subject:"–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞ (—ç–ª–µ–∫—Ç–∏–≤)",type:"5 –¥–Ω–µ–π",dateRanges:"11/02, 25/02, 11/03, 25/03, 08/04",dayOfWeek:3,category:"pe",professor:"–ö–∞—Ñ. –§–∏–∑–≤–æ—Å–ø–∏—Ç–∞–Ω–∏—è",location:"–§–û–ö –∫–æ—Ä–ø—É—Å ‚Ññ6",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",dates:[]},
            {day:"–°—Ä–µ–¥–∞",time:"12:20‚Äì13:50",subject:"–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞ (2-—è –≥—Ä—É–ø–ø–∞)",type:"4 –¥–Ω—è",dateRanges:"20/05‚Äì10/06",dayOfWeek:3,category:"pe",professor:"–ö–∞—Ñ. –§–∏–∑–≤–æ—Å–ø–∏—Ç–∞–Ω–∏—è",location:"–§–û–ö –∫–æ—Ä–ø—É—Å ‚Ññ6",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",dates:[]},
            {day:"–ß–µ—Ç–≤–µ—Ä–≥",time:"08:30‚Äì10:00",subject:"–¶–ò–ö–õ",type:"09/02‚Äì11/06",dateRanges:"09/02‚Äì11/06",dayOfWeek:4,category:"cycle",isCycle:true,cycleDay:"thursday",dates:[]},
            {day:"–ß–µ—Ç–≤–µ—Ä–≥",time:"10:10‚Äì11:40",subject:"–¶–ò–ö–õ",type:"09/02‚Äì11/06",dateRanges:"09/02‚Äì11/06",dayOfWeek:4,category:"cycle",isCycle:true,cycleDay:"thursday",dates:[]},
            {day:"–ß–µ—Ç–≤–µ—Ä–≥",time:"11:50‚Äì13:20",subject:"–û–±—â–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è",type:"1 –¥–µ–Ω—å",dateRanges:"30/04",dayOfWeek:4,category:"surgery",professor:"–ö–∞—Ñ. –û–±—â–µ–π —Ö–∏—Ä—É—Ä–≥–∏–∏",location:"–°–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141",dates:[]},
            {day:"–ß–µ—Ç–≤–µ—Ä–≥",time:"12:20‚Äì13:50",subject:"–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ (–†–ö–ò)",type:"5 –¥–Ω–µ–π",dateRanges:"19/03‚Äì16/04",dayOfWeek:4,category:"rki",professor:"–ö–∞—Ñ. –†—É—Å—Å–∫–æ–≥–æ –∏ –ª–∞—Ç–∏–Ω—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",dates:[]},
            {day:"–ß–µ—Ç–≤–µ—Ä–≥",time:"12:20‚Äì13:50",subject:"–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è",type:"5 –¥–Ω–µ–π",dateRanges:"07/05‚Äì04/06",dayOfWeek:4,category:"pharma",professor:"–ö–∞—Ñ. –§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ö—É—Ç—è–∫–æ–≤–∞,109",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ö—É—Ç—è–∫–æ–≤–∞+109",dates:[]},
            {day:"–ß–µ—Ç–≤–µ—Ä–≥",time:"14:00‚Äì15:30",subject:"–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è",type:"5 –¥–Ω–µ–π",dateRanges:"07/05‚Äì04/06",dayOfWeek:4,category:"pharma",professor:"–ö–∞—Ñ. –§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ö—É—Ç—è–∫–æ–≤–∞,109",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ö—É—Ç—è–∫–æ–≤–∞+109",dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"08:30‚Äì10:00",subject:"–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è",type:"4 –¥–Ω—è",dateRanges:"15/05‚Äì05/06",dayOfWeek:5,category:"pharma",professor:"–ö–∞—Ñ. –§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ö—É—Ç—è–∫–æ–≤–∞,109",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ö—É—Ç—è–∫–æ–≤–∞+109",dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"10:10‚Äì11:40",subject:"–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è",type:"4 –¥–Ω—è",dateRanges:"15/05‚Äì05/06",dayOfWeek:5,category:"pharma",professor:"–ö–∞—Ñ. –§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ö—É—Ç—è–∫–æ–≤–∞,109",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ö—É—Ç—è–∫–æ–≤–∞+109",dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"10:40‚Äì12:10",subject:"–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",type:"2 –¥–Ω—è",dateRanges:"13/03, 20/03",dayOfWeek:5,category:"health",professor:"–ö–∞—Ñ. –û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è",location:"–∫–æ—Ä–ø—É—Å ‚Ññ6 –°–ì–ú–£",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"12:20‚Äì13:50",subject:"–¶–ò–ö–õ",type:"09/02‚Äì11/06",dateRanges:"09/02‚Äì11/06",dayOfWeek:5,category:"cycle",isCycle:true,cycleDay:"friday",dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"14:00‚Äì15:30",subject:"–¶–ò–ö–õ",type:"09/02‚Äì11/06",dateRanges:"09/02‚Äì11/06",dayOfWeek:5,category:"cycle",isCycle:true,cycleDay:"friday",dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"16:10‚Äì17:40",subject:"–ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∞–Ω–∞—Ç–æ–º–∏—è",type:"6 –¥–Ω–µ–π",dateRanges:"13/02, 27/02, 13/03, 27/03, 10/04, 24/04",dayOfWeek:5,category:"anatomy",professor:"–ö–∞—Ñ. –ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –∞–Ω–∞—Ç–æ–º–∏–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ4 –°–ì–ú–£",address:"—É–ª.–ë.–ö–∞–∑–∞—á—å—è,112",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–ö–∞–∑–∞—á—å—è+112",conflict:true,dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"16:10‚Äì17:40",subject:"–ù–µ–æ—Ç–ª–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è",type:"2 –¥–Ω—è",dateRanges:"20/02, 06/03",dayOfWeek:5,category:"emergency",professor:"–ö–∞—Ñ. –°–∫–æ—Ä–æ–π –ø–æ–º–æ—â–∏",location:"–∫–æ—Ä–ø—É—Å ‚Ññ7 –£–ö–ë ‚Ññ1",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",conflict:true,dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"16:10‚Äì17:40",subject:"–û–±—â–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è",type:"1 –¥–µ–Ω—å",dateRanges:"20/03",dayOfWeek:5,category:"surgery",professor:"–ö–∞—Ñ. –û–±—â–µ–π —Ö–∏—Ä—É—Ä–≥–∏–∏",location:"–°–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141",conflict:true,dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"16:10‚Äì17:40",subject:"–ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –±–æ–ª–µ–∑–Ω–µ–π",type:"4 –¥–Ω—è",dateRanges:"03/04, 17/04, 15/05, 22/05",dayOfWeek:5,category:"propedeutics",professor:"–ö–∞—Ñ. –ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∏",location:"–ì–ö–ë ‚Ññ2",address:"—É–ª.–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ,141",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ+141",conflict:true,dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"16:10‚Äì17:40",subject:"–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞",type:"2 –¥–Ω—è",dateRanges:"29/05, 05/06",dayOfWeek:5,category:"pe",professor:"–ö–∞—Ñ. –§–∏–∑–≤–æ—Å–ø–∏—Ç–∞–Ω–∏—è",location:"–§–û–ö –∫–æ—Ä–ø—É—Å ‚Ññ6",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",conflict:true,dates:[]},
            {day:"–ü—è—Ç–Ω–∏—Ü–∞",time:"18:10‚Äì19:40",subject:"–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞",type:"13 –¥–Ω–µ–π",dateRanges:"13/02‚Äì24/04, 15/05‚Äì22/05",dayOfWeek:5,category:"pe",professor:"–ö–∞—Ñ. –§–∏–∑–≤–æ—Å–ø–∏—Ç–∞–Ω–∏—è",location:"–§–û–ö –∫–æ—Ä–ø—É—Å ‚Ññ6",address:"—É–ª.–ë.–°–∞–¥–æ–≤–∞—è,137",mapLink:"https://yandex.ru/maps/?text=–°–∞—Ä–∞—Ç–æ–≤+—É–ª.+–ë–æ–ª—å—à–∞—è+–°–∞–¥–æ–≤–∞—è+137",dates:[]}
        ];
        lessonsData.forEach(l=>{l.dates=parseDateRange(l.dateRanges,l.dayOfWeek);});
        let favorites=JSON.parse(localStorage.getItem('favorites2026')||'[]');
        let hiddenCategories=JSON.parse(localStorage.getItem('hiddenCategories2026')||'[]');
        function init(){renderLegend();renderSchedule();updateFavCount();const di=document.getElementById('dateSearch');di.min='2026-02-09';di.max='2026-06-11';}
        function renderLegend(){const c={'pharma':'–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è','anatomy':'–ü–∞—Ç. –∞–Ω–∞—Ç–æ–º–∏—è','pathophys':'–ü–∞—Ç–æ—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—è','surgery':'–•–∏—Ä—É—Ä–≥–∏—è','propedeutics':'–ü—Ä–æ–ø–µ–¥–µ–≤—Ç–∏–∫–∞','immunology':'–ò–º–º—É–Ω–æ–ª–æ–≥–∏—è','rki':'–†–ö–ò','cycle':'–¶–ò–ö–õ','emergency':'–ù–µ–æ—Ç–ª–æ–∂–Ω–∞—è –ø–æ–º–æ—â—å','health':'–û–±—â. –∑–¥–æ—Ä–æ–≤—å–µ','topographic':'–¢–æ–ø–æ–≥—Ä–∞—Ñ. –∞–Ω–∞—Ç–æ–º–∏—è','biochem':'–ö–ª–∏–Ω. –±–∏–æ—Ö–∏–º–∏—è','pe':'–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞'};document.getElementById('legend').innerHTML='<h3>üé® –§–∏–ª—å—Ç—Ä –ø—Ä–µ–¥–º–µ—Ç–æ–≤</h3><div class="legend-items">'+Object.entries(c).map(([k,v])=>'<div class="legend-item '+(hiddenCategories.includes(k)?'hidden':'')+'" onclick="toggleCategory(\''+k+'\')"><div class="color-box '+k+'"></div><span>'+v+'</span></div>').join('')+'</div>';}
        function toggleCategory(c){if(hiddenCategories.includes(c))hiddenCategories=hiddenCategories.filter(x=>x!==c);else hiddenCategories.push(c);localStorage.setItem('hiddenCategories2026',JSON.stringify(hiddenCategories));renderSchedule(document.getElementById('dateSearch').value?fmtD(document.getElementById('dateSearch').value):null);renderLegend();}
        function fmtD(v){const[y,m,d]=v.split('-');return d+'/'+m;}
        function calcProg(l){if(!l.dates||!l.dates.length)return{total:0,passed:0,remaining:0,percent:0,next:null};const cs=getFormattedDate(CURRENT_DATE);const passed=l.dates.filter(d=>{const[dy,mn]=d.split('/').map(Number);const[cd,cm]=cs.split('/').map(Number);return(mn<cm)||(mn===cm&&dy<cd);}).length;const rem=l.dates.length-passed;const pct=Math.round((passed/l.dates.length)*100);const next=l.dates.find(d=>{const[dy,mn]=d.split('/').map(Number);const[cd,cm]=cs.split('/').map(Number);return(mn>cm)||(mn===cm&&dy>=cd);});return{total:l.dates.length,passed,remaining:rem,percent:pct,next};}
        function getCycleD(l,sd=null){if(!l.isCycle||!l.cycleDay)return null;const cs=cycleData[l.cycleDay];if(!cs)return null;if(sd){const[sD,sM]=sd.split('/').map(Number);const so=new Date(2026,sM-1,sD);for(let c of cs){for(let p of c.period.split(', ')){if(p.includes('‚Äì')){const[st,en]=p.split('‚Äì');const[s1,s2]=st.trim().split('/').map(Number);const[e1,e2]=en.trim().split('/').map(Number);if(so>=new Date(2026,s2-1,s1)&&so<=new Date(2026,e2-1,e1))return[c];}}}}return cs;}
        function renderSchedule(fd=null,ss=false){const g=document.getElementById('scheduleGrid');const days=['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫','–í—Ç–æ—Ä–Ω–∏–∫','–°—Ä–µ–¥–∞','–ß–µ—Ç–≤–µ—Ä–≥','–ü—è—Ç–Ω–∏—Ü–∞'];g.innerHTML='';let tL=0,tP=0,tR=0;days.forEach(day=>{let dl=lessonsData.filter(l=>l.day===day&&!hiddenCategories.includes(l.category));if(fd){dl=dl.filter(l=>l.dates.includes(fd));if(!dl.length)return;}tL+=dl.length;const card=document.createElement('div');card.className='day-card active';let lH=dl.map(lesson=>{const iF=favorites.includes(day+'-'+lesson.time+'-'+lesson.subject);const gi=lessonsData.indexOf(lesson);const p=calcProg(lesson);tP+=p.passed;tR+=p.remaining;const pH=p.total>0?'<div class="lesson-progress"><div class="progress-text"><span>–ü—Ä–æ–π–¥–µ–Ω–æ: '+p.passed+'/'+p.total+'</span><span>'+p.percent+'%</span></div><div class="progress-bar"><div class="progress-fill" style="width:'+p.percent+'%"></div></div>'+(p.next?'<div class="next-lesson">üìÖ –°–ª–µ–¥—É—é—â–µ–µ: '+p.next+'/2026</div>':'<div class="next-lesson" style="color:#e53e3e;">‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>')+'</div>':'';let cH='';if(lesson.isCycle&&lesson.cycleDay){const cd=getCycleD(lesson,fd);if(cd&&cd.length){if(fd){const ac=cd[0];cH='<div class="cycle-details"><div class="cycle-item"><span><strong>'+ac.name+'</strong></span><span class="cycle-period">'+ac.period+'</span></div><div style="font-size:0.85em;color:#666;margin-top:5px;">üìç '+ac.location+', '+ac.address+'</div></div>';}else{cH='<div class="cycle-details">'+cd.map(c=>'<div class="cycle-item"><span><strong>'+c.name+'</strong></span><span class="cycle-period">'+c.period+'</span></div>').join('')+'</div>';}}}return'<div class="lesson '+lesson.category+(fd?' current-day':'')+'" onclick="openModal('+gi+(fd?',\''+fd+'\'':'')+')"><span class="favorite-star '+(iF?'active':'')+'" onclick="event.stopPropagation();toggleFav(\''+day+'\',\''+lesson.time+'\',\''+lesson.subject+'\');">'+(iF?'‚òÖ':'‚òÜ')+'</span><div class="lesson-header"><div class="lesson-time">'+lesson.time+'</div><div class="lesson-title">'+lesson.subject+'</div><div class="lesson-badge">'+lesson.type+'</div></div>'+(fd?'<div style="padding:0 15px 10px;font-size:0.9em;color:#666;">üìÖ '+fd+'/2026</div>':'')+cH+pH+'</div>';}).join('');if(day==='–ü—è—Ç–Ω–∏—Ü–∞'&&!fd&&dl.some(l=>l.time==='16:10‚Äì17:40'&&l.conflict))lH='<div class="conflict-notice">‚ö†Ô∏è 16:10‚Äì17:40 ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω –ø–æ –¥–∞—Ç–∞–º</div>'+lH;card.innerHTML='<div class="day-header"><span>üóìÔ∏è '+day+'</span>'+(fd?'<span style="font-size:0.6em;background:#ffd700;color:#000;padding:5px 10px;border-radius:15px;">'+fd+'</span>':'')+'</div>'+lH;g.appendChild(card);});if(ss&&fd){document.getElementById('statsGrid').innerHTML='<div class="stat-card"><div class="stat-number">'+tL+'</div><div class="stat-label">–í—Å–µ–≥–æ</div></div><div class="stat-card"><div class="stat-number" style="color:#48bb78;">'+tP+'</div><div class="stat-label">–ü—Ä–æ–π–¥–µ–Ω–æ</div></div><div class="stat-card"><div class="stat-number" style="color:#ed8936;">'+tR+'</div><div class="stat-label">–û—Å—Ç–∞–ª–æ—Å—å</div></div>';document.getElementById('statsBar').classList.add('active');}else document.getElementById('statsBar').classList.remove('active');}
        function showToday(){const ts=getFormattedDate(CURRENT_DATE);const dw=CURRENT_DATE.getDay();if(dw===0||dw===6){alert('üéâ –í—ã—Ö–æ–¥–Ω–æ–π!');return;}document.getElementById('dateSearch').value='';renderSchedule(ts,true);const i=document.getElementById('resultsInfo');i.innerHTML='üåÖ –°–ï–ì–û–î–ù–Ø: <strong>'+getRussianDate(CURRENT_DATE)+'</strong> | <button onclick="clearS()" style="background:none;border:none;color:#22543d;text-decoration:underline;cursor:pointer;">–°–±—Ä–æ—Å–∏—Ç—å</button>';i.classList.add('active');}
        function showTomorrow(){const t=new Date(CURRENT_DATE);t.setDate(t.getDate()+1);const ts=getFormattedDate(t);const dw=t.getDay();if(dw===0||dw===6){alert('üåÑ –ó–∞–≤—Ç—Ä–∞ –≤—ã—Ö–æ–¥–Ω–æ–π!');return;}document.getElementById('dateSearch').value='';renderSchedule(ts,true);const i=document.getElementById('resultsInfo');i.innerHTML='üåÑ –ó–ê–í–¢–†–ê: <strong>'+getRussianDate(t)+'</strong> | <button onclick="clearS()" style="background:none;border:none;color:#22543d;text-decoration:underline;cursor:pointer;">–°–±—Ä–æ—Å–∏—Ç—å</button>';i.classList.add('active');}
        function searchByDate(){const v=document.getElementById('dateSearch').value;if(!v)return;const sd=fmtD(v);const hl=lessonsData.some(l=>l.dates.includes(sd)&&!hiddenCategories.includes(l.category));renderSchedule(sd,true);const[y,m,d]=v.split('-');document.getElementById('resultsInfo').innerHTML='üìÖ '+d+'.'+m+'.'+y+' | <button onclick="clearS()" style="background:none;border:none;color:#22543d;text-decoration:underline;cursor:pointer;">–°–±—Ä–æ—Å–∏—Ç—å</button>';document.getElementById('resultsInfo').classList.add('active');document.getElementById('noResults').classList.toggle('active',!hl);}
        function showAll(){document.getElementById('dateSearch').value='';document.getElementById('resultsInfo').classList.remove('active');document.getElementById('noResults').classList.remove('active');document.getElementById('statsBar').classList.remove('active');renderSchedule();}
        function clearS(){showAll();}function clearSearch(){showAll();}
        function exportICS(){try{const n=new Date();const ds=n.getUTCFullYear()+String(n.getUTCMonth()+1).padStart(2,'0')+String(n.getUTCDate()).padStart(2,'0')+'T'+String(n.getUTCHours()).padStart(2,'0')+String(n.getUTCMinutes()).padStart(2,'0')+String(n.getUTCSeconds()).padStart(2,'0')+'Z';let ic='BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//–°–ì–ú–£//RU\nCALSCALE:GREGORIAN\nX-WR-CALNAME:–°–ì–ú–£ 2026\n';lessonsData.forEach((l,li)=>{if(!l.dates||hiddenCategories.includes(l.category))return;if(l.isCycle&&l.cycleDay){const cs=cycleData[l.cycleDay];if(cs)cs.forEach((c,ci)=>{c.period.split(', ').forEach((p,pi)=>{if(p.includes('‚Äì')){const[st,en]=p.split('‚Äì');const[sd,sm]=st.trim().split('/').map(Number);const[ed,em]=en.trim().split('/').map(Number);let cu=new Date(2026,sm-1,sd);const eD=new Date(2026,em-1,ed);while(cu<=eD){if(cu.getDay()===l.dayOfWeek){const df=getFormattedDate(cu);const[d,m]=df.split('/').map(Number);const[sh,si]=l.time.split('‚Äì')[0].split(':');const[eh,ei]=l.time.split('‚Äì')[1].split(':');ic+='BEGIN:VEVENT\nDTSTART:2026'+String(m).padStart(2,'0')+String(d).padStart(2,'0')+'T'+sh+si+'00\nDTEND:2026'+String(m).padStart(2,'0')+String(d).padStart(2,'0')+'T'+eh+ei+'00\nDTSTAMP:'+ds+'\nUID:c'+li+ci+pi+d+m+'@sgmu\nSUMMARY:'+c.name+' (–¶–ò–ö–õ)\nLOCATION:'+c.location+'\nBEGIN:VALARM\nACTION:DISPLAY\nDESCRIPTION:–ó–∞–Ω—è—Ç–∏–µ\nTRIGGER:-PT10M\nEND:VALARM\nEND:VEVENT\n';}cu.setDate(cu.getDate()+1);}}});});}else{l.dates.forEach((d,di)=>{const[dy,mn]=d.split('/');const[sh,si]=l.time.split('‚Äì')[0].split(':');const[eh,ei]=l.time.split('‚Äì')[1].split(':');ic+='BEGIN:VEVENT\nDTSTART:2026'+mn+dy+'T'+sh+si+'00\nDTEND:2026'+mn+dy+'T'+eh+ei+'00\nDTSTAMP:'+ds+'\nUID:l'+li+di+d.replace('/','')+'@sgmu\nSUMMARY:'+l.subject+'\nLOCATION:'+(l.location||'')+'\nBEGIN:VALARM\nACTION:DISPLAY\nDESCRIPTION:–ó–∞–Ω—è—Ç–∏–µ\nTRIGGER:-PT10M\nEND:VALARM\nEND:VEVENT\n';});}});ic+='END:VCALENDAR';const b=new Blob([ic],{type:'text/calendar'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='sgmu-2026.ics';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u);setTimeout(()=>alert('üìÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ! –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ Google Calendar / Outlook.'),100);}catch(e){alert('‚ùå '+e.message);}}
        function openModal(li,sd=null){const l=lessonsData[li];if(!l)return;document.getElementById('modalTitle').textContent=l.subject;document.getElementById('modalTime').textContent=l.day+' | '+l.time;const p=calcProg(l);const dd=l.dates.length?l.dates.map(d=>'<span class="date-tag">'+d+'/2026</span>').join(''):'<span style="color:#999">–ù–µ—Ç</span>';const pD=p.total?'<div class="info-section" style="background:linear-gradient(135deg,#f0fff4,#c6f6d5);"><h3>üìä –ü—Ä–æ–≥—Ä–µ—Å—Å</h3><div style="display:flex;justify-content:space-between;"><span>'+p.passed+'/'+p.total+'</span><span style="font-weight:bold;color:#2f855a;">'+p.percent+'%</span></div><div class="progress-bar"><div class="progress-fill" style="width:'+p.percent+'%"></div></div>'+(p.next?'<p style="color:#2b6cb0;">üìÖ –°–ª–µ–¥—É—é—â–µ–µ: '+p.next+'/2026</p>':'<p style="color:#e53e3e;">‚úÖ –í—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã!</p>')+'</div>':'';let cD='';if(l.isCycle&&l.cycleDay){const cs=cycleData[l.cycleDay];if(cs){let ac=null;if(sd){const[s1,s2]=sd.split('/').map(Number);const so=new Date(2026,s2-1,s1);for(let c of cs){for(let pp of c.period.split(', ')){if(pp.includes('‚Äì')){const[st,en]=pp.split('‚Äì');const[a1,a2]=st.trim().split('/').map(Number);const[b1,b2]=en.trim().split('/').map(Number);if(so>=new Date(2026,a2-1,a1)&&so<=new Date(2026,b2-1,b1)){ac=c;break;}}}if(ac)break;}}if(ac)cD='<div class="info-section" style="background:linear-gradient(135deg,#e6fffa,#b2f5ea);border-left-color:#38b2ac;"><h3>üè• –†–æ—Ç–∞—Ü–∏—è ('+sd+')</h3><p><strong>'+ac.name+'</strong></p><p>üìç '+ac.location+', '+ac.address+'</p><a href="'+ac.mapLink+'" target="_blank" class="map-link">üó∫Ô∏è –ö–∞—Ä—Ç–∞</a></div>';else cD='<div class="info-section"><h3>üè• –†–æ—Ç–∞—Ü–∏–∏</h3>'+cs.map(c=>'<div style="margin:10px 0;padding:10px;background:white;border-radius:8px;"><strong>'+c.name+'</strong><br><span style="color:#666;">üìÖ '+c.period+'</span><br>üìç '+c.location+', '+c.address+'<br><a href="'+c.mapLink+'" target="_blank" class="map-link" style="font-size:0.85em;">üó∫Ô∏è –ö–∞—Ä—Ç–∞</a></div>').join('')+'</div>';}}document.getElementById('modalBody').innerHTML=pD+cD+'<div class="info-section"><h3>üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</h3><p>'+(l.professor||'‚Äî')+'</p></div><div class="info-section"><h3>üìç –ú–µ—Å—Ç–æ</h3><p><strong>'+(l.location||'')+'</strong><br>'+(l.address||'')+'</p>'+(l.mapLink?'<a href="'+l.mapLink+'" target="_blank" class="map-link">üó∫Ô∏è –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã</a>':'')+'</div><div class="info-section"><h3>üìÖ –î–∞—Ç—ã ('+l.type+')</h3><div class="dates-list">'+dd+'</div></div>'+(l.conflict?'<div style="background:#fff5f5;color:#c53030;padding:15px;border-radius:8px;border-left:4px solid #fc8181;margin-top:15px;"><strong>‚ö†Ô∏è</strong> –ù–µ—Å–∫–æ–ª—å–∫–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω –≤ —ç—Ç–æ –≤—Ä–µ–º—è</div>':'');document.getElementById('modal').classList.add('active');document.body.style.overflow='hidden';}
        function closeModal(e){if(!e||e.target.id==='modal'){document.getElementById('modal').classList.remove('active');document.body.style.overflow='';}}
        function toggleFav(d,t,s){const k=d+'-'+t+'-'+s;const i=favorites.indexOf(k);if(i>-1)favorites.splice(i,1);else favorites.push(k);localStorage.setItem('favorites2026',JSON.stringify(favorites));updateFavCount();renderSchedule();}
        function updateFavCount(){document.getElementById('favCount').textContent=favorites.length;}
        function showFavorites(){if(!favorites.length){alert('‚≠ê –ü—É—Å—Ç–æ!');return;}let h='<h2 style="color:var(--primary);margin-bottom:20px;">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h2>';favorites.forEach(f=>{const[d,t,...sp]=f.split('-');const s=sp.join('-');const l=lessonsData.find(x=>x.day===d&&x.time===t&&x.subject===s);if(l){const p=calcProg(l);h+='<div style="background:#f7fafc;padding:15px;border-radius:12px;margin-bottom:15px;border-left:4px solid #f56565;"><strong style="color:var(--primary);">'+s+'</strong><div style="color:#666;margin:5px 0;">'+d+' | '+t+'</div><div style="font-size:0.85em;"><span style="color:#48bb78;">‚úÖ'+p.passed+'</span> / <span style="color:#ed8936;">‚è≥'+p.remaining+'</span></div><button onclick="toggleFav(\''+d+'\',\''+t+'\',\''+s+'\');showFavorites()" style="margin-top:10px;background:#fc8181;color:white;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;">–£–¥–∞–ª–∏—Ç—å</button></div>';}});document.getElementById('modalBody').innerHTML=h;document.getElementById('modalTitle').textContent='–ò–∑–±—Ä–∞–Ω–Ω–æ–µ';document.getElementById('modalTime').textContent=favorites.length+' —à—Ç.';document.getElementById('modal').classList.add('active');}
        document.addEventListener('keydown',e=>{if(e.key==='Escape')closeModal();});
        let deferredPrompt=null;
        if('serviceWorker' in navigator){navigator.serviceWorker.register('service-worker.js').then(r=>console.log('‚úÖ SW:',r.scope)).catch(e=>console.log('SW err:',e));}
        window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();deferredPrompt=e;document.getElementById('installBtn').style.display='flex';if(!localStorage.getItem('installDismissed2026'))setTimeout(()=>document.getElementById('installBanner').classList.add('active'),3000);});
        function installPWA(){if(deferredPrompt){deferredPrompt.prompt();deferredPrompt.userChoice.then(r=>{if(r.outcome==='accepted'){document.getElementById('installBanner').classList.remove('active');document.getElementById('installBtn').style.display='none';}deferredPrompt=null;});}else alert('üì≤ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:\n\nüçé iOS: Safari ‚Üí –ü–æ–¥–µ–ª–∏—Ç—å—Å—è ‚Üí –ù–∞ —ç–∫—Ä–∞–Ω –î–æ–º–æ–π\nü§ñ Android: Chrome ‚Üí ‚ãÆ ‚Üí –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å');}
        function dismissInstall(){document.getElementById('installBanner').classList.remove('active');localStorage.setItem('installDismissed2026','true');}
        window.addEventListener('appinstalled',()=>{document.getElementById('installBanner').classList.remove('active');document.getElementById('installBtn').style.display='none';});
        window.addEventListener('online',()=>document.getElementById('offlineBadge').classList.remove('active'));
        window.addEventListener('offline',()=>document.getElementById('offlineBadge').classList.add('active'));
        if(!navigator.onLine)document.getElementById('offlineBadge').classList.add('active');
        init();
    </script>
</body>
</html>